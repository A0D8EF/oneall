{% extends "oneall/base.html" %}
{% load static %}


{% block extra_head %}
<title>NEWS －ONE/ALL</title>
<link rel="stylesheet" href="{% static 'news/css/index.css' %}">
<link rel="stylesheet" href="{% static 'news/css/detail.css' %}">
<script>
    let DELETE_URL  = "{% url 'news:detail' 1 %}";
    let RETURN_URL  = "{% url 'news:index' %}"
</script>
<script src="{% static 'news/js/ajax.js' %}"></script>
<script src="{% static 'news/js/detail.js' %}"></script>
{% endblock %}

{% block main %}
<h1>NEWS</h1>
<div class="news_detail border">
    {% if request.user.is_teacher %}
    <input type="checkbox" id="news_edit_chk">
    <div class="news_icons">
        <label class="news_icon edit" value="{{ news.id }}" for="news_edit_chk"><i class="fa-solid fa-pen"></i></label>
        <button class="news_icon trash" value="{{ news.id }}"><i class="fa-solid fa-trash-can"></i></button>
    </div>
    {% endif %}
    <div class="news_detail_content">
        <h3>{{ news.title }}</h3>
        <label class="news_category_label">{{ news.category.name|default:'未分類' }}</label>
        <div>{{ news.user.handle_name }}</div>
        <div>{{ news.dt|date:'Y/m/d' }}</div>
        <div>{{ news.content|linebreaksbr|urlize }}</div>
    </div>
    <!-- 編集フォーム -->
    <div class="news_detail_edit">
        <form action="{% url 'news:detail' news.id %}" id="news_edit_form">
            <h3><input type="text" name="title" value="{{ news.title }}"></h3>
            <select name="category">
                {% for category in categories %}
                <option value="{{ category.id }}" {% if category.id == news.category.id %}selected{% endif %}>{{ category.name }}</option>
                {% endfor %}
            </select>
            <div>{{ news.user.handle_name }}</div>
            <input type="date" value="{{ news.dt }}">
            <textarea name="content" class="form-control" rows="10">{{ news.content }}</textarea>
            <button class="btn btn-primary" id="submit_edit">編集</button>
            <label for="news_edit_chk" class="btn btn-danger mt-2">キャンセル</label>
        </form>
    </div>
</div>
{% endblock %}